<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>Typed up CRUD SPA with Haskell and Elm - Part 5: Elm 0.17 Upgrade</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <meta name="keywords" content="">
    <meta name="generator" content="JBake">

    <link href="/blog/css/bootstrap.min.css" rel="stylesheet">
    <link href="/blog/css/asciidoctor.css" rel="stylesheet">
    <link href="/blog/css/base.css" rel="stylesheet">
    <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
    <link href="/blog/css/prettify.css" rel="stylesheet">
    <link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="/js/html5shiv.js"></script>
    <![endif]-->

    <!-- Fav and touch icons -->
    <!--<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/blog/assets/ico/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/blog/assets/ico/apple-touch-icon-114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/blog/assets/ico/apple-touch-icon-72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" href="/blog/assets/ico/apple-touch-icon-57-precomposed.png">-->
    <link rel="shortcut icon" href="../favicon.ico">
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-58695124-1', 'auto');
      ga('send', 'pageview');

    </script>
  </head>
  <body onload="prettyPrint()">
    <div id="wrap">

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/blog/index.html">Rundis</a>
        </div>
        <div class="navbar-collapse collapse bs-navbar-collapse">
            <ul class="nav navbar-nav">
                <li><a href="/blog/archive.html">Archive</a></li>
                <li><a href="/blog/about.html">About</a></li>
                <li><a href="/blog/feed.xml">Subscribe</a></li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="https://github.com/rundis/blog"><i class="fa fa-lg fa-github"></i></a>
                </li>
            </ul>
        </div>
    </div>
</div>
<div class="container">

	<div class="page-header">
		<h1>Typed up CRUD SPA with Haskell and Elm - Part 5: Elm 0.17 Upgrade</h1>
	</div>

	<p><em>30 May 2016</em></p>
  <p><em>Tags: </em>
    <a href="/blog/tags/haskell.html">haskell</a>
  </em>
    <a href="/blog/tags/elm.html">elm</a>
  </em>
    <a href="/blog/tags/haskellelmspa.html">haskellelmspa</a>
  </p>
  <a href="https://twitter.com/share" class="twitter-share-button"
    data-url="http://rundis.github.io/blog/2016/haskel_elm_spa_part5.html"
    data-via="mrundberget"
    data-lang="en">Tweet</a>
  <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>

	<p><div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Elm version 0.17 was released a few weeks back. If haven&#8217;t already, you should read the annoucement post
<a href="http://elm-lang.org/blog/farewell-to-frp">A Farewell to FRP</a>. So what does that mean for the Albums app ?
Sounds like we&#8217;re in for a massive rewrite. It turns out, since we were already using The Elm Architecture to
structure our application, the impact isn&#8217;t that big after all. Most of it is mechanical, and actually the biggest change
is that we can no longer use the 3.rd party routing library we depended on.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<div class="title">Useful resources</div>
<ul>
<li>
<p>Check out the other <a href="http://rundis.github.io/blog/tags/haskellelmspa.html">episodes</a> in this blog series.</p>
</li>
<li>
<p>The accompanying <a href="https://github.com/rundis/albums">Albums</a> sample app is on github, and there is a tag
for each episode</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div id="toc" class="toc">
<div id="toctitle" class="title">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_introduction">Introduction</a></li>
<li><a href="#_upgrade_steps">Upgrade steps</a>
<ul class="sectlevel2">
<li><a href="#_upgrading_packages">Upgrading packages</a></li>
<li><a href="#_mechanical_changes">Mechanical changes</a></li>
<li><a href="#_routes_and_route_parsing_ehh_urls_if_you_like">Routes and Route parsing (ehh&#8230;&#8203; URLs if you like)</a></li>
<li><a href="#_dealing_with_http">Dealing with Http</a></li>
<li><a href="#_nesting_components">Nesting Components</a></li>
<li><a href="#_wiring_it_all_together_in_frontend_src_main_elm">Wiring it all together in frontend/src/Main.elm</a></li>
</ul>
</li>
<li><a href="#_summary">Summary</a>
<ul class="sectlevel2">
<li><a href="#_appendix">Appendix</a></li>
</ul>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_introduction">Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>I would have done the upgrade to 0.17 sooner, but the Album application depended on a 3rd party package
called <a href="https://github.com/etaque/elm-transit-router">elm-transit-router</a>. It served us well and we even got some nice
transition animations when changing pages. However as all the routing libraries that we&#8217;re available for 0.16, it
depended on a community package called elm-history. That package was never going to updated to support 0.17, in fact
all support for the Web Platform APIs will eventually supported by the Elm language.</p>
</div>
<div class="paragraph">
<p>Last week <a href="https://github.com/elm-lang/navigation">Navigation</a> was announced. This is library for managing navigation in a SPA. It provides nice abstractions over the History API.
In tandem Evan released <a href="https://github.com/evancz/url-parser">URL Parser</a> which is a simple parser for turning URLs into structured data.</p>
</div>
<div class="paragraph">
<p>With that in place I felt confident we should be able to do the upgrade. Let&#8217;s walk through the highlights !</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_upgrade_steps">Upgrade steps</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_upgrading_packages">Upgrading packages</h3>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 1. /frontend/elm-package.json</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">0.17</th>
<th class="tableblock halign-left valign-top">0.16</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JavaScript" data-lang="JavaScript">"dependencies": {
  "elm-community/elm-json-extra": "1.0.0 &lt;= v &lt; 2.0.0",
  "elm-community/list-extra": "2.0.0 &lt;= v &lt; 3.0.0",
  "elm-lang/core": "4.0.0 &lt;= v &lt; 5.0.0",
  "elm-lang/html": "1.0.0 &lt;= v &lt; 2.0.0",
  "elm-lang/navigation": "1.0.0 &lt;= v &lt; 2.0.0",
  "evancz/elm-http": "3.0.1 &lt;= v &lt; 4.0.0",
  "evancz/url-parser": "1.0.0 &lt;= v &lt; 2.0.0"
},
"elm-version": "0.17.0 &lt;= v &lt; 0.18.0"</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-JavaScript" data-lang="JavaScript">"dependencies": {
    "circuithub/elm-list-extra": "3.9.0 &lt;= v &lt; 4.0.0",   <i class="conum" data-value="1"></i><b>(1)</b>
    "elm-lang/core": "3.0.0 &lt;= v &lt; 4.0.0",
    "etaque/elm-route-parser": "2.1.0 &lt;= v &lt; 3.0.0",
    "etaque/elm-transit-router": "1.0.1 &lt;= v &lt; 2.0.0",   <i class="conum" data-value="2"></i><b>(2)</b>
    "etaque/elm-transit-style": "1.0.1 &lt;= v &lt; 2.0.0",
    "evancz/elm-effects": "2.0.1 &lt;= v &lt; 3.0.0",          <i class="conum" data-value="3"></i><b>(3)</b>
    "evancz/elm-html": "4.0.2 &lt;= v &lt; 5.0.0",             <i class="conum" data-value="4"></i><b>(4)</b>
    "evancz/elm-http": "3.0.0 &lt;= v &lt; 4.0.0",
    "evancz/start-app": "2.0.2 &lt;= v &lt; 3.0.0"             <i class="conum" data-value="5"></i><b>(5)</b>
},
"elm-version": "0.16.0 &lt;= v &lt; 0.17.0"</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><a href="https://github.com/elm-community/">Elm Community</a> have taken over this package</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>elm-transit-router</code>, <code>elm-route-parser</code>, <code>elm-transit-style</code> have been replaced by <code>elm-lang/navigation</code> and <code>evancz/url-parser</code>
(pls note you can still use <code>etaque/elm-route-parser</code> with the navigation package if you need more advanced route parsing)</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>This package has been baked into core of Elm for 0.17, so this package is no longer needed</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>This package has moved under the <code>elm-lang</code> umbrella. So has it&#8217;s low level <a href="https://github.com/elm-lang/virtual-dom">virtual-dom</a> transitive dependency</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>This package has basically been moved into <code>elm-lang/html</code></td>
</tr>
</table>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_mechanical_changes">Mechanical changes</h3>
<div class="sect3">
<h4 id="_module_declarations">Module declarations</h4>
<div class="paragraph">
<p>In 0.16 we had</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-elm" data-lang="elm">module Main (..) where</code></pre>
</div>
</div>
<div class="paragraph">
<p>In 0.17 we have</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-elm" data-lang="elm">module Main exposing (..)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Luckily <a href="https://github.com/avh4/elm-format">Elm Format</a> handles this conversion automatically for us when we do format of an 0.16 .elm file !
So we can just run elm-format on the <code>src</code> directory.</p>
</div>
</div>
<div class="sect3">
<h4 id="_effects_are_now_named_code_cmd_code">Effects are now named <code>Cmd</code></h4>
<div class="paragraph">
<p>The new name for Effects are now <code>Cmd</code> shorthand for Command. <code>Cmd</code> is part of <code>elm-lang/core</code>
and lives in the <a href="http://package.elm-lang.org/packages/elm-lang/core/4.0.1/Platform-Cmd">Platform.Cmd</a> module</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 2. Changes to a typical update function</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">0.17</th>
<th class="tableblock halign-left valign-top">0.16</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-elm" data-lang="elm">type Msg
    = SomeMsg
    | SomeOtherMsg


update : Msg -&gt; Model -&gt; ( Model, Cmd Msg )         <i class="conum" data-value="1"></i><b>(1)</b>
update msg model =
    case msg of
       SomeMsg -&gt;
           ( { model | count = model.count + 1 }
           , Cmd.none                               <i class="conum" data-value="2"></i><b>(2)</b>
           )
       -- etc...</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>You&#8217;ll also notice that <code>Action</code> has changed to <code>Msg</code>. It&#8217;s just a naming convention change
, but it better conveys what it actually is. You&#8217;ll see later when we get to the view function why it&#8217;s probably a good idea for you to
follow that convention.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>As you see, here it&#8217;s just a naming change in practice</td>
</tr>
</table>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-elm" data-lang="elm">type Action
    = SomeAction
    | SomeOtherAction


update : Action -&gt; Model -&gt; ( Model, Effects Action )
update action model =
    case action of
        SomeAction -&gt;
            ( { model | count = model.count + 1 }
            , Effects.none
            )
        -- etc...</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Making these changes is also fairly trivial with a good old search/replace.</p>
</div>
</div>
<div class="sect3">
<h4 id="_mailbox_and_address_are_gone_in_0_17">Mailbox and address are gone in 0.17</h4>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 3. Changes to a typical view function</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">0.17</th>
<th class="tableblock halign-left valign-top">0.16</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-elm" data-lang="elm">view : Model -&gt; Html Msg           <i class="conum" data-value="1"></i><b>(1)</b>
view model =
    button
        [ onClick SomeMsg ]        <i class="conum" data-value="2"></i><b>(2)</b>
        [ text "DoStuff" ]</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-elm" data-lang="elm">view : Signal.Address Action -&gt; Model -&gt; Html
view address model =
    button
        [ onClick address SomeMsg ]
        [ text "DoStuff"]</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The address parameter is gone, you no longer need to concern yourself with the intricacies of mailboxes.
But you&#8217;ll also notice that the return value type <code>Html</code> takes a tag which in this case is our <code>Msg</code> type. So if we have any event handlers
in our view code, we are telling it that those should result in a message of type <code>Msg</code>. We&#8217;ll come back to this in a bit more detail when we go through a nesting example.</p>
</li>
<li>
<p>We no longer need to deal with an address for our event handler, we just tell Elm that when the user clicks the button, it should
trigger our update function with the given <code>Msg</code> <code>SomeMsg</code>. The Elm runtime will take care of routing the message to our update function without any address mumbojumbo !</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Again making this change is largely a matter of search/replace. There are a few exceptions though.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 4. on "input" is now luckily onInput !</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">0.17</th>
<th class="tableblock halign-left valign-top">0.16</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-elm" data-lang="elm">[ input
  [ class "form-control"
  , value model.name
  , onInput SetAlbumName
  ]
  []
]</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-elm" data-lang="elm">[ input
  [ class "form-control"
  , value model.name
  , on "input"
        targetValue
        (\str -&gt; Signal.message address (SetAlbumName str))
  ]
  []
]</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>But let&#8217;s say you actually do need a custom decoder it would still be simpler than in 0.16</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-elm" data-lang="elm">import Json.Decode as Json

-- ...

[ input
  [ class "form-control"
  , value model.name
  , on "input" (Json.map SetArtistName targetValue) <i class="conum" data-value="1"></i><b>(1)</b>
  ]
  []
]</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Here we just map over the targetValue, and call SetArtistName with the value. <code>targetValue</code> is a Json decoder which picks out the value from our input field when the event is triggered</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_routes_and_route_parsing_ehh_urls_if_you_like">Routes and Route parsing (ehh&#8230;&#8203; URLs if you like)</h3>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 5. Route definitions</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">0.17</th>
<th class="tableblock halign-left valign-top">0.16</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-elm" data-lang="elm">type Route
    = Home
    | ArtistListingPage
    | ArtistDetailPage Int
    | NewArtistPage
    | AlbumDetailPage Int
    | NewArtistAlbumPage Int</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-elm" data-lang="elm">type Route
  = Home
  | ArtistListingPage
  | ArtistDetailPage Int
  | NewArtistPage
  | AlbumDetailPage Int
  | NewAlbumPage
  | NewArtistAlbumPage Int
  | EmptyRoute</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>So the only change here is basically the removal of a couple of routes that weren&#8217;t in use.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 6. Route parsing</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">0.17 (url-parser)</th>
<th class="tableblock halign-left valign-top">0.16 (elm-route-parser)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-elm" data-lang="elm">routeParser : Parser (Route -&gt; a) a
routeParser =
    oneOf
        [ format Home (s "")
        , format NewArtistPage (s "artists" &lt;/&gt; s "new")
        , format NewArtistAlbumPage
                 (s "artists" &lt;/&gt; int &lt;/&gt; s "albums" &lt;/&gt; s "new")
        , format ArtistDetailPage (s "artists" &lt;/&gt; int)
        , format ArtistListingPage (s "artists")
        , format AlbumDetailPage (s "albums" &lt;/&gt; int)
        ]


decode : Location -&gt; Result String Route
decode location =
    parse identity routeParser (String.dropLeft 1 location.pathname)</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-elm" data-lang="elm">routeParsers : List (Matcher Route)
routeParsers =
  [ static Home "/"
  , static ArtistListingPage "/artists"
  , static NewArtistPage "/artists/new"
  , dyn1 ArtistDetailPage "/artists/" int ""
  , dyn1 AlbumDetailPage "/albums/" int ""
  , static NewAlbumPage "/albums/new"
  , dyn1 NewArtistAlbumPage "/artists/" int "/albums/new"
  ]



decode : String -&gt; Route
decode path =
  RouteParser.match routeParsers path
    |&gt; Maybe.withDefault EmptyRoute</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The parsing syntax is slightly different, but the transition was fairly trivial in our case.
The observant reader will notice that we&#8217;ve skipped over the case when there is not matching route.
We&#8217;ll get back to that when we wire it all together.</p>
</div>
<div class="listingblock">
<div class="title">Encoding</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-elm" data-lang="elm">encode : Route -&gt; String
encode route =
    case route of
        Home -&gt;
            "/"

        ArtistListingPage -&gt;
            "/artists"

        NewArtistPage -&gt;
            "/artists/new"

        ArtistDetailPage i -&gt;
            "/artists/" ++ toString i

        AlbumDetailPage i -&gt;
            "/albums/" ++ toString i

        NewArtistAlbumPage i -&gt;
            "/artists/" ++ (toString i) ++ "/albums/new"</code></pre>
</div>
</div>
<div class="paragraph">
<p>Encoding routes is pretty much exactly the same as before.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 7. Handy helpers</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">0.17 (url-parser)</th>
<th class="tableblock halign-left valign-top">0.16 (elm-route-parser)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-elm" data-lang="elm">navigate : Route -&gt; Cmd msg                     <i class="conum" data-value="1"></i><b>(1)</b>
navigate route =
    Navigation.newUrl (encode route)


linkTo : Route -&gt; List (Attribute msg) -&gt; List (Html msg) -&gt; Html msg
linkTo route attrs content =                    <i class="conum" data-value="2"></i><b>(2)</b>
    a ((linkAttrs route) ++ attrs) content


linkAttrs : Route -&gt; List (Attribute msg)
linkAttrs route =
    let
        path =
            encode route
    in
        [ href path
        , attribute "data-navigate" path       <i class="conum" data-value="3"></i><b>(3)</b>
        ]


catchNavigationClicks : (String -&gt; msg) -&gt; Attribute msg
catchNavigationClicks tagger =                 <i class="conum" data-value="4"></i><b>(4)</b>
    onWithOptions "click"
        { stopPropagation = True
        , preventDefault = True
        }
        (Json.map tagger (Json.at [ "target" ] pathDecoder))


pathDecoder : Json.Decoder String              <i class="conum" data-value="5"></i><b>(5)</b>
pathDecoder =
    Json.oneOf
        [ Json.at [ "data-navigate" ] Json.string
        , Json.at [ "parentElement" ] (lazy (\_ -&gt; pathDecoder))
        , Json.fail "no path found for click"
        ]</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>A couple of places in the Album app we wish to be able to navigate to a new page as a result of some logic
in the update function is some component. Tbh we might be better off inlining this
in the relevant update functions.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>This is a handy convenience function for creating a link to one of our defined routes (aka pages in our App)</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>In addition to the href attribute we define a <code>data-navigate</code> attribute which we can use for a catch all handler we&#8217;ll come to in a second</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>This function allows us to catch all link clicks for a given element and all it&#8217;s child elments.
It prevents the browser from making the url reguest and rather allows us to provide a custom tagger function that receives the Url in question and can create a message as a result.
It will make more sence to you when you see how it&#8217;s used in our Main module later on.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>A Json parser which will recursivly walk through the element tree for the node receiving the event and try to find an element with the <code>data-navigage</code> attribute defined.</td>
</tr>
</table>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-elm" data-lang="elm">redirect : Route -&gt; Effects ()
redirect route =
  encode route
    |&gt; Signal.send TransitRouter.pushPathAddress
    |&gt; Effects.task


clickAttr : Route -&gt; Attribute
clickAttr route =
  on "click" Json.value (\_ -&gt;  Signal.message TransitRouter.pushPathAddress &lt;| encode route)


linkAttrs : Route -&gt; List Attribute
linkAttrs route =
  let
    path = encode route
  in
    [ href path
    , onWithOptions
        "click"
        { stopPropagation = True, preventDefault = True }
        Json.value
        (\_ -&gt;  Signal.message TransitRouter.pushPathAddress path)
    ]</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
I borrowed most of this code from <a href="https://github.com/etaque/tacks">The tacks application from @etaque</a>. Kudos to @etaque for coming up with this !
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Please be adviced that these helpers do make a compromise in terms of type safety.
I&#8217;m sure in due time, more type safe patterns will emerge.  An obvious alternative to this approach is to
have a custom message in each update function that handles navigation. I&#8217;m going to try that out in the near future and see how it plays out.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_sample_usage">Sample usage</h4>
<div class="paragraph">
<p>Let&#8217;s have a quick look at a few examples on how we are using the <code>navigate</code> and <code>linkTo</code> helper functions
in the Albums app. How it all fits together will hopefully be apparent when we describe how we wire everything together in our <code>Main</code> module a little later on</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 8. artistRow function in frontend/src/ArtistDetails.elm</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">0.17</th>
<th class="tableblock halign-left valign-top">0.16</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-elm" data-lang="elm">artistRow : Artist -&gt; Html Msg
artistRow artist =
    tr []
        [ td [] [ text artist.name ]
        , td []
            [ Routes.linkTo (Routes.ArtistDetailPage artist.id) <i class="conum" data-value="1"></i><b>(1)</b>
                [ class "btn btn-sm btn-default" ]
                [ text "Edit" ]
            ]
        , td []
            [ button
                [ class "btn btn-sm btn-danger"
                , onClick &lt;| DeleteArtist (.id artist)          <i class="conum" data-value="2"></i><b>(2)</b>
                ]
                [ text "Delete!" ]
            ]
        ]</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Here we are creating a normal link using the helper function described earlier. The result of clicking it should just be navigation, so sending a message to the ArtistListing <code>update</code> function which then creates the navigation effect feels like it might be to much work/boilerplate</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Here the primary thing we want to handle is not navigation, the primary concern is handling deletion so we follow the normal pattern of returning a Msg which will be routed to our update function for handling</td>
</tr>
</table>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-elm" data-lang="elm">artistRow : Signal.Address Action -&gt; Artist -&gt; Html
artistRow address artist =
  tr
    []
    [ td [] [ text artist.name ]
    , td
        []
        [ button
            [ class "btn btn-sm btn-default"
            , Routes.clickAttr
                &lt;| Routes.ArtistDetailPage artist.id
            ]
            [ text "Edit" ]
        ]
    , td
        []
        [ button
            [ class "btn btn-sm btn-danger"
            , onClick address (DeleteArtist (.id artist))
            ]
            [ text "Delete!" ]
        ]
    ]</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 9. update function in frontend/src/ArtistDetail.elm</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">0.17</th>
<th class="tableblock halign-left valign-top">0.16</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-elm" data-lang="elm">-- ...

HandleSaved artist -&gt;
    ( { model
        | id = Just artist.id
        , name = artist.name
      }
      , Routes.navigate Routes.ArtistListingPage <i class="conum" data-value="1"></i><b>(1)</b>
    )
-- ...</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Upon successfully saving an artist to our backend service, we create a Cmd (aka request for an effect to be performed), using our util function, to route the user to the
ArtistListingPage</td>
</tr>
</table>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-elm" data-lang="elm">HandleSaved maybeArtist -&gt;
  case maybeArtist of
    Just artist -&gt;
      ( { model
          | id = Just artist.id
          , name = artist.name
        }
      , Effects.map (\_ -&gt; NoOp)
                    (Routes.redirect Routes.ArtistListingPage)
      )

    Nothing -&gt;
      Debug.crash "Save failed... we're not handling it..."</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_dealing_with_http">Dealing with Http</h3>
<div class="paragraph">
<p>So in our Album app we separated all HTTP requests to a separate module we called <code>ServerApi</code>.
The changes from 0.16 to 0.17 isn&#8217;t massive, but since we&#8217;re at it we might as well make some small improvements
to be better prepared for error handling in future episodes.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">0.17</th>
<th class="tableblock halign-left valign-top">0.16</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-elm" data-lang="elm">getArtist :
  Int
  -&gt; (Http.Error -&gt; msg)
  -&gt; (Artist -&gt; msg)
  -&gt; Cmd msg
getArtist id errorMsg msg =
    Http.get artistDecoder
            (baseUrl ++ "/artists/" ++ toString id)
        |&gt; Task.perform errorMsg msg</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-elm" data-lang="elm">getArtist : Int -&gt; (Maybe Artist -&gt; a) -&gt; Effects.Effects a
getArtist id action =
  Http.get artistDecoder (baseUrl ++ "/artists/" ++ toString id)
    |&gt; Task.toMaybe
    |&gt; Task.map action
    |&gt; Effects.task</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The http methods haven&#8217;t really changed, but the manner in which we request the runtime to perform them have changed.
We no longer have the Effects package, so we need to use <code>Task.perform</code> to do it now. Our 0.16 implementation used
Maybe to signal success or failure, in 0.17 we have opted to give a different message for success or failure.
So if <code>getArtist</code> fails the error result of or http action will be passed to our update function wrapped in the provided Msg given by our <code>errorMsg</code> param,
if it succeeds the response will be json decoded and passed to our update function wrapped in the provided Msg given by our <code>msg</code> param.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Separating out all our http requests in one module gives flexibility in usage from multiple modules, but comes with a price of reduced type safety though.
<strong>You</strong> might want to localize http stuff with your components to make them more self-contained.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_usage_comparison">Usage Comparison</h4>
<div class="listingblock">
<div class="title">frontend/src/AlbumDetail.elm 0.16</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-elm" data-lang="elm">update : Action -&gt; Model -&gt; ( Model, Effects Action )
update action model =
  case action of
    NoOp -&gt;
      ( model, Effects.none )

    GetAlbum id -&gt;
      ( model
      , Effects.batch
          [ getAlbum id ShowAlbum
          , getArtists HandleArtistsRetrieved
          ]
      )

    ShowAlbum maybeAlbum -&gt;
      case maybeAlbum of
        Just album -&gt;
          ( createAlbumModel model album, Effects.none )

        Nothing -&gt; -- TODO: This could be an error if returned from api !
          ( maybeAddPristine model, getArtists HandleArtistsRetrieved )

    HandleArtistsRetrieved xs -&gt;
      ( { model | artists = (Maybe.withDefault [] xs) }
      , Effects.none
      )</code></pre>
</div>
</div>
<div class="paragraph">
<p>Our use of Maybe to signal failure in our 0.16 implementation clearly muddles what&#8217;s going on in terms of potential failures.</p>
</div>
<div class="listingblock">
<div class="title">frontend/src/AlbumDetail.elm 0.17</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-elm" data-lang="elm">mountAlbumCmd : Int -&gt; Cmd Msg                                    <i class="conum" data-value="1"></i><b>(1)</b>
mountAlbumCmd id =
    Cmd.batch
        [ getAlbum id FetchAlbumFailed ShowAlbum
        , getArtists FetchArtistsFailed HandleArtistsRetrieved
        ]


mountNewAlbumCmd : Cmd Msg                                        <i class="conum" data-value="2"></i><b>(2)</b>
mountNewAlbumCmd =
    getArtists FetchArtistsFailed HandleArtistsRetrieved


update : Msg -&gt; Model -&gt; ( Model, Cmd Msg )
update msg model =
    case msg of
        -- TODO: show error
        FetchAlbumFailed err -&gt;                                   <i class="conum" data-value="3"></i><b>(3)</b>
            ( model, Cmd.none )

        ShowAlbum album -&gt;                                        <i class="conum" data-value="4"></i><b>(4)</b>
            ( createAlbumModel model album, Cmd.none )

        HandleArtistsRetrieved artists' -&gt;
            ( { model | artists = artists' }
            , Cmd.none
            )

        -- TODO: show error
        FetchArtistsFailed err -&gt;
            ( model, Cmd.none )

        -- rest left out for brevity</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>This command has been separated out as an exposed function for the module. The reason is that we need to perform this
when we navigate to a `/albums/&lt;id&gt;. I.e when that particular url is mounted. You&#8217;ll see how when we cover the Main module.
We are actually running two http requests here.. hopefully/presumably in the order they are listed :-)</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Similar to the above, but this is for handling when the user navigates to the url for creating a <em>new</em> album</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>if getAlbum should fail this is where we should handle that (And we will eventually in a future episode)</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>If getAlbum succeeds we set the model up for displaying the retrieved artist</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_nesting_components">Nesting Components</h3>
<div class="paragraph">
<p>The way you handle nesting of components in 0.17 has changed (for the better) with the removal of Mailboxes.
If you didn&#8217;t do to much fancy stuff with addresses the transition to 0.17 should be quite straight forward.
We&#8217;ll illustrate by showing a simple/common transition and then we will show how you might handle a more complex
nesting scenario (based on actual examples from the Albums App)</p>
</div>
<div class="sect3">
<h4 id="_the_common_scenario">The common scenario</h4>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 10. update function in frontend/src/Main.elm</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">0.17</th>
<th class="tableblock halign-left valign-top">0.16</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-elm" data-lang="elm">update : Msg -&gt; Model -&gt; ( Model, Cmd Msg )
update msg model =
    case msg of
        HomeMsg m -&gt;
            let
                ( subMdl, subCmd ) =
                    Home.update m model.homeModel
            in
                { model | homeModel = subMdl }
                    ! [ Cmd.map HomeMsg subCmd ]   <i class="conum" data-value="1"></i><b>(1)</b>
        -- ...</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>So rather than using <code>Effects.map</code> to map the result action(s) of effects from a child component, we use <code>Cmd.map</code> to map result msg(s) from a child component
to a Msg that is known to the parent module.</td>
</tr>
</table>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-elm" data-lang="elm">update : Action -&gt; Model -&gt; ( Model, Effects Action )
update action model =
  case action of
    HomeAction homeAction -&gt;
      let
        ( subMdl, effects ) =
          Home.update homeAction model.homeModel
      in
        ( { model | homeModel = subMdl }
        , Effects.map HomeAction effects
        )

    -- ...</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>I think you&#8217;ll agree this change is pretty simple to deal with. Let&#8217;s see how nesting of view functions
for components have changed</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 11. contentView function in frontend/src/Main.elm</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">0.17</th>
<th class="tableblock halign-left valign-top">0.16</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-elm" data-lang="elm">contentView : Model -&gt; Html Msg
contentView model =
    case model.route of                             <i class="conum" data-value="1"></i><b>(1)</b>
        Home -&gt;
            App.map HomeMsg                         <i class="conum" data-value="2"></i><b>(2)</b>
                    &lt;| Home.view model.homeModel

        -- ...</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>As we did in 0.16 we keep track of the current route in our model</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>App.map is shorthand for Html.App.map. So we need to map between the <code>Msg</code> type returned from the view function in the Home module
to a <code>Msg</code> type that is known to our Main module. In this instance it&#8217;s <code>HomeMsg</code>. We need to do this mapping so that when the msg is passed
pack into our root update function we know which msg we should forward to which subcomponent.</td>
</tr>
</table>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-elm" data-lang="elm">contentView : Signal.Address Action -&gt; Model -&gt; Html
contentView address model =
  case (TransitRouter.getRoute model) of
    Home -&gt;
      Home.view (Signal.forwardTo address HomeAction)  <i class="conum" data-value="1"></i><b>(1)</b>
                model.homeModel</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Signal.forwardTo essentially achieved the same effect, but it&#8217;s way less intuitive to grasp. It&#8217;s unlikely you&#8217;ll miss it much !</td>
</tr>
</table>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>This change isn&#8217;t quite search/replace (well with regex perhaps), but it&#8217;s quite trivial too.
Ok let&#8217;s move onto something a bit more complex.</p>
</div>
</div>
<div class="sect3">
<h4 id="_a_more_complex_scenario_album_and_tracks">A more complex scenario - Album and tracks</h4>
<div class="paragraph">
<p>If you wish to see the Album and Tracks solution in action, you can check it out here:</p>
</div>
<iframe width="420" height="315" src="https://www.youtube.com/embed/RU0NB2xaQIg" frameborder="0" allowfullscreen></iframe>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 12. update function in frontend/src/TrackRow.elm</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">0.17</th>
<th class="tableblock halign-left valign-top">0.16</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-elm" data-lang="elm">type Msg
    = SetTrackName String
    | SetMinutes String
    | SetSeconds String
    | Dispatch DispatchMsg                             <i class="conum" data-value="1"></i><b>(1)</b>


type DispatchMsg                                       <i class="conum" data-value="2"></i><b>(2)</b>
    = MoveUp
    | MoveDown
    | Remove


update : Msg -&gt; Model -&gt; ( Model, Maybe DispatchMsg )  <i class="conum" data-value="3"></i><b>(3)</b>
update msg model =
    case msg of
        SetTrackName v -&gt;
            ( { model | name = v, status = Modified }
            , Nothing                                  <i class="conum" data-value="4"></i><b>(4)</b>
            )

        SetMinutes str -&gt;
            -- ...

        SetSeconds str -&gt;
            -- ...

        Dispatch dispatchMsg -&gt;                        <i class="conum" data-value="5"></i><b>(5)</b>
            ( model, Just dispatchMsg )</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We add a new Msg tag called <code>Dispatch</code> which has a payload of type <code>DispatchMsg</code> to model
messages we would like to notify the parent of this component to handle</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>DispatchMsg becomes part of the public Api for our component so we need to expose it from our module</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The way we notify the parent in this solution is to add a return value, so now we return a tuple of Model and Maybe a DispatchMsg the parent
should respond to.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>For the component internal messages there is nothing extra the parent should respond to, so we simply return <code>Nothing</code> as a DispatchMsg</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>For all dispatch messages we return the concrete dispatch message tag that we want the parent to handle</td>
</tr>
</table>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-elm" data-lang="elm">type Action
  = SetTrackName String
  | SetMinutes String
  | SetSeconds String


update : Action -&gt; Model -&gt; Model
update action model =
  case action of
    SetTrackName v -&gt;
      { model | name = v, status = Modified }

    SetMinutes str -&gt;
      -- ..


    SetSeconds str -&gt;
      -- ..</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>There is no magic involved here, we are just returning an additional piece of info in the return value of
our update function.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 13. view function in frontend/src/TrackRow.elm</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">0.17</th>
<th class="tableblock halign-left valign-top">0.16</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-elm" data-lang="elm">view : Model -&gt; Html Msg
view model =
    tr []
        [ td [] [ statusView model ]
        , td [] [ moveView model ]
        , td [] [ nameView model ]
        , td [] [ durationView model ]
        , td [] [ removeView model ]
        ]

removeView : Model -&gt; Html Msg
removeView model =
    button
        [ onClick (Dispatch Remove)           <i class="conum" data-value="1"></i><b>(1)</b>
        , class
            &lt;| "btn btn-sm btn-danger "
            ++ if isPristine model then
                "disabled"
               else
                ""
        ]
        [ text "Remove" ]

-- ...</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>When the user clicks the remove button, we simply return a Msg with the tag <code>Dispatch</code> carrying a <code>DispatchMsg</code> with the tag <code>Remove</code>
This msg will be routed through the top-level update function, through the update function in <code>AlbumDetailPage</code> and finally to the update function in <code>TrackRow</code>.
There it will be handled by the <code>Dispatch dispatchMsg &#8594;</code> case and simply returned to the parent (<code>AlbumDetailPage</code>)</td>
</tr>
</table>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-elm" data-lang="elm">type alias Context =                          <i class="conum" data-value="1"></i><b>(1)</b>
  { actions : Signal.Address Action
  , remove : Signal.Address ()
  , moveUp : Signal.Address ()
  , moveDown : Signal.Address ()
  }


view : Context -&gt; Model -&gt; Html
view context model =
  tr
    []
    [ td [] [ statusView model ]
    , td [] [ moveView context model ]
    , td [] [ nameView context model ]
    , td [] [ durationView context model ]
    , td [] [ removeView context model ]
    ]


removeView : Context -&gt; Model -&gt; Html
removeView context model =
  button
    [ onClick context.remove ()             <i class="conum" data-value="2"></i><b>(2)</b>
    , class &lt;| "btn btn-sm btn-danger "
            ++ if isPristine model then
                  "disabled"
               else ""
    ]
    [ text "Remove" ]

-- ..</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>In our 0.16 implementation we used this funny type and made it part of the public Api
as an extra param to the view function.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>This looks super-weird to someone who doesn&#8217;t intuitively know that <code>()</code> is <code>Unit</code>.
 <code>onClick</code> takes 2 parameters an address and an Action. In this case context.remove is the first param and <code>()</code> is the second !
There is little point in explaining further, let&#8217;s just agreed that this isn&#8217;t very intuitive ?</td>
</tr>
</table>
</div></div></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">0.16 implementation of update function in frontend/src/AlbumDetail.elm</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-elm" data-lang="elm">update : Action -&gt; Model -&gt; ( Model, Effects Action )
update action model =
  case action of
    -- ...

    RemoveTrack id -&gt;
      ( { model \| tracks = List.filter (\( rowId, _ ) -&gt; rowId /= id) model.tracks }
      , Effects.none
      )

    MoveTrackUp id -&gt;
      -- ...
    MoveTrackDown id -&gt;
      -- ...

    ModifyTrack id trackRowAction -&gt;
      let
        updateTrack ( trackId, trackModel ) =
          if trackId == id then
            ( trackId, TrackRow.update trackRowAction trackModel )
          else
            ( trackId, trackModel )
      in
        ( maybeAddPristine { model | tracks = List.map updateTrack model.tracks }
        , Effects.none
        )</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">0.17 implementation of update function in frontend/src/AlbumDetail.elm</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-elm" data-lang="elm">update : Msg -&gt; Model -&gt; ( Model, Cmd Msg )
update msg model =
    case msg of
        -- ...

        RemoveTrack id -&gt;                                      <i class="conum" data-value="1"></i><b>(1)</b>
            ( { model \| tracks = List.filter (\( rowId, _ ) -&gt; rowId /= id) model.tracks
              }
            , Cmd.none
            )

        MoveTrackUp id -&gt;
            -- ...

        MoveTrackDown id -&gt;
            -- ...

        ModifyTrack id trackRowMsg -&gt;
            case (modifyTrack id trackRowMsg model) of        <i class="conum" data-value="2"></i><b>(2)</b>
                Just ( updModel, Nothing ) -&gt;                 <i class="conum" data-value="3"></i><b>(3)</b>
                    ( model, Cmd.none )

                Just ( updModel, Just dispatchMsg ) -&gt;        <i class="conum" data-value="4"></i><b>(4)</b>
                    handleDispatch id dispatchMsg updModel

                _ -&gt;
                    ( model, Cmd.none )                       <i class="conum" data-value="5"></i><b>(5)</b>


modifyTrack : TrackRowId -&gt; TrackRow.Msg -&gt; Model -&gt; Maybe ( Model, Maybe TrackRow.DispatchMsg )
modifyTrack id msg model =                                    <i class="conum" data-value="6"></i><b>(6)</b>
    ListX.find (\( trackId, _ ) -&gt; id == trackId) model.tracks
        \|&gt; Maybe.map (\( _, trackModel ) -&gt; TrackRow.update msg trackModel)
        \|&gt; Maybe.map
            (\( updTrack, dispatchMsg ) -&gt;
                ( maybeAddPristine
                    { model
                        \| tracks =
                            ListX.replaceIf (\( i, _ ) -&gt; i == id)
                                ( id, updTrack )
                                model.tracks
                    }
                , dispatchMsg
                )
            )


handleDispatch : TrackRowId -&gt; TrackRow.DispatchMsg -&gt; Model -&gt; ( Model, Cmd Msg )
handleDispatch id msg model =                                <i class="conum" data-value="7"></i><b>(7)</b>
    case msg of
        TrackRow.MoveDown -&gt;
            update (MoveTrackDown id) model

        TrackRow.MoveUp -&gt;
            update (MoveTrackUp id) model

        TrackRow.Remove -&gt;
            update (RemoveTrack id) model</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The parent, ie AlbumDetail, logic for deleting on of it&#8217;s track rows</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We delegate updating the track row and consequently the AlbumDetail model to a helper function.
We pattern match on the result from that function.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>If it was a "normal" update with no dispatch message returned we simply return the updated model and a no op Cmd</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>If the update of the track row got a dispatch message in return from TrackRow.update we delegate the handling of the
dispatch message to another helper function.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Since we are dealing with Maybe values we have to handle this case, but it really shouldn&#8217;t ever happen ! (famous last words)</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>This might look a bit scary, but in summary it; locates the correct track row, performs the update of that row by delegating to TrackRow update,
updates the track row in the model with the updated track row and finally returns a tuple of the updated model and the dispatch message (which is Maybe you remember)</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>Here we simply pattern match on the dispatch message and invokes the update function with the appropriate corresponding <code>Msg</code></td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The pattern we used here is just one of many possible ways of solving this problem. Maybe someday a common preferred pattern will emerge,
but the bottom line is that it will most likely be some variation of return values from update functions and/or input params to the view function in the parent/child communucation.
The days of "magic" juggling with mailboxes are gone. Simple input/output FTW !
Oh, and finally, for this particular case I think there might be a good case for arguing that perhaps remove/moveup/movedown doesn&#8217;t really belong in <code>TrackRow</code> at all, it might
actually make more sence to use a decorator-kind of approach instead.
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Some flavors of using "global" or dummy effects (using say dummy tasks) for communicating between components have briefly surfaced. Pls think really carefully
before adopting such an approach. Have a chat with the nice and very knowledgable people in the community to discuss
if there isn&#8217;t a better solution for your problem !
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_wiring_it_all_together_in_frontend_src_main_elm">Wiring it all together in frontend/src/Main.elm</h3>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 14. main</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">0.17</th>
<th class="tableblock halign-left valign-top">0.16</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-elm" data-lang="elm">main : Program Never
main =
    Navigation.program                       <i class="conum" data-value="1"></i><b>(1)</b>
      (Navigation.makeParser Routes.decode)
        { init = init
        , view = view
        , update = update
        , urlUpdate = urlUpdate              <i class="conum" data-value="2"></i><b>(2)</b>
        , subscriptions = \_ -&gt; Sub.none     <i class="conum" data-value="3"></i><b>(3)</b>
        }</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Rather that start-app we are using the program function from Navigation. The first
param is a function to creates a parser- So bootstrap it with our Routes.decode function.
The second param is a config record similar to the one in start-app but not quite</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Hey what&#8217;s this fellow, it seems we need to provide a function to handle URL updates in our application !</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>We don&#8217;t have any subscriptions in our app, so we can just return Sub.none for that function.</td>
</tr>
</table>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-elm" data-lang="elm">app : StartApp.App Model
app =
  StartApp.start
    { init = init initialPath
    , update = update
    , view = view
    , inputs = [ actions ]                  <i class="conum" data-value="1"></i><b>(1)</b>
    }


main : Signal Html
main =
  app.html


port tasks : Signal (Task.Task Never ())   <i class="conum" data-value="2"></i><b>(2)</b>
port tasks =
  app.tasks

port initialPath : String                  <i class="conum" data-value="3"></i><b>(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Inputs was sort of like subscriptions. We needed that in our 0.16 because of elm-transit-router which used elm-history which again provided a signal for url changes.
All of that is gone and handled by navigation, but slightly differently.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Just a thing you had to define if you had effects in your App in 0.16. We&#8217;re happy it&#8217;s gone !</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>We had to provide the initialPath (url) through a port in 0.16</td>
</tr>
</table>
</div></div></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 15. Model and init stuff</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">0.17</th>
<th class="tableblock halign-left valign-top">0.16</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-elm" data-lang="elm">type alias Model =
    { route : Routes.Route
    , homeModel : Home.Model
    , artistListingModel : ArtistListing.Model
    , artistDetailModel : ArtistDetail.Model
    , albumDetailModel : AlbumDetail.Model
    }

initialModel : Model
initialModel =
    { route = Home
    , homeModel = Home.init
    , artistListingModel = ArtistListing.init
    , artistDetailModel = ArtistDetail.init
    , albumDetailModel = AlbumDetail.init
    }


init : Result String Route -&gt; ( Model, Cmd Msg )  <i class="conum" data-value="1"></i><b>(1)</b>
init result =
    urlUpdate result initialModel</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>init</code> is called for us by Navigation.program using our provided parser so
we get a result from the parsing of the initial url. We pass that on to the yet to be described
urlUpdate function along with our initial model.</td>
</tr>
</table>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-elm" data-lang="elm">type alias Model =
  WithRoute
    Routes.Route
    { homeModel : Home.Model
    , artistListingModel : ArtistListing.Model
    , artistDetailModel : ArtistDetail.Model
    , albumDetailModel : AlbumDetail.Model
    }

initialModel : Model
initialModel =
  { transitRouter = TransitRouter.empty Routes.EmptyRoute
  , homeModel = Home.init
  , artistListingModel = ArtistListing.init
  , artistDetailModel = ArtistDetail.init
  , albumDetailModel = AlbumDetail.init
  }


init : String -&gt; ( Model, Effects Action )
init path =
  let
    usePath = if path == "/index.html" then "/" else path
  in
    TransitRouter.init routerConfig usePath initialModel</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>I don&#8217;t think it&#8217;s much point in describing the other slight differences, since they mostly pertain to
details about elm-transit-router.</p>
</div>
<div class="sect3">
<h4 id="_url_updates_mounting_routes">Url updates / Mounting routes</h4>
<div class="listingblock">
<div class="title">mounting routes in 0.16</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-elm" data-lang="elm">mountRoute : Route -&gt; Route -&gt; Model -&gt; ( Model, Effects Action )
mountRoute prevRoute route model =
  case route of
    Home -&gt;
      ( model, Effects.none )

    ArtistListingPage -&gt;
      ( model, Effects.map ArtistListingAction (ServerApi.getArtists ArtistListing.HandleArtistsRetrieved) )

    ArtistDetailPage artistId -&gt;
      ( model
      , Effects.map ArtistDetailAction (ServerApi.getArtist artistId ArtistDetail.ShowArtist) )

    NewArtistPage -&gt;
      ( { model | artistDetailModel = ArtistDetail.init }, Effects.none )

    -- etc ..

    EmptyRoute -&gt;                <i class="conum" data-value="1"></i><b>(1)</b>
      ( model, Effects.none )</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>This is how we handled route parse failures in our 0.16 implementation btw.</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">urlUpdate in 0.17</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-elm" data-lang="elm">urlUpdate : Result String Route -&gt; Model -&gt; ( Model, Cmd Msg )
urlUpdate result model =
    case result of
        Err _ -&gt;                                                            <i class="conum" data-value="1"></i><b>(1)</b>
            model ! [ Navigation.modifyUrl (Routes.encode model.route) ]

        Ok (ArtistListingPage as route) -&gt;                                  <i class="conum" data-value="2"></i><b>(2)</b>
            { model | route = route }
                ! [ Cmd.map ArtistListingMsg ArtistListing.mountCmd ]

        -- rest left out for brevity

        Ok ((NewArtistAlbumPage artistId) as route) -&gt;                      <i class="conum" data-value="3"></i><b>(3)</b>
            { model
                | route = route
                , albumDetailModel = AlbumDetail.initForArtist artistId
            }
                ! [ Cmd.map AlbumDetailMsg AlbumDetail.mountNewAlbumCmd ]

        Ok route -&gt;                                                         <i class="conum" data-value="4"></i><b>(4)</b>
            { model | route = route } ! []</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>If url parsing for a new url fails we just change the url back to url for the current route(/page)
It might be  appropriate to show an error of some sort error.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>When the we change url to the artist listing page we wish to initiate the http request for retrieving
artists from our backend. That&#8217;s where ArtistListing.mountCmd comes into the picture.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>In addition to providing an effect, we need to ensure that the albumDetailModel starts with a clean slate
when the page for adding a new album is displayed. It might have been a good idea to separate this out to it&#8217;s own component to avoid quite a bit of coniditional logic.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>For any other url changes we just update the route field in our model</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>What&#8217;s up with the <code>! []</code> thing ?</strong></p>
</div>
<div class="paragraph">
<p><code>!</code> is a shorthand infix function with the following signature <code>(!) : model &#8594; List (Cmd msg) &#8594; (model, Cmd msg)</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-elm" data-lang="elm">model ! [someCmd, someOtherCmd] == (model, Sub.batch [someCmd, SomeOtherCmd])</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_just_a_little_more_on_the_main_update_function_related_to_navigation">Just a little more on the main update function, related to navigation</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">0.17</th>
<th class="tableblock halign-left valign-top">0.16</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-elm" data-lang="elm">update : Msg -&gt; Model -&gt; ( Model, Cmd Msg )
update msg model =
    case msg of

        -- other actions left out

        Navigate url -&gt;
            model ! [ Navigation.newUrl url ]</code></pre>
</div>
</div>
<div class="paragraph">
<p>The navigate message triggers a call to the Navigation.newUrl function. That will step to a new url
and update the browser history. You&#8217;ll see in the next chapter were we trigger this message.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-elm" data-lang="elm">update : Action -&gt; Model -&gt; ( Model, Effects Action )
update action model =
  case action of

    -- other actions left out

    RouterAction routeAction -&gt;
      TransitRouter.update routerConfig routeAction model</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is a elm-transit-router specific handler that takes care of starting and stopping animation transitions
+ updating the route field of our model</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_view">View</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">0.17</th>
<th class="tableblock halign-left valign-top">0.16</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-elm" data-lang="elm">view : Model -&gt; Html Msg
view model =
    div
        [ class "container-fluid"
        , Routes.catchNavigationClicks Navigate  <i class="conum" data-value="1"></i><b>(1)</b>
        ]
        [ menu model
        , div [ class "content" ]
            [ contentView model ]                <i class="conum" data-value="2"></i><b>(2)</b>
        ]</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Here our catch all navigation related clicks helper function comes into play. So for any navigation related clicks, we return a <code>Navigate</code> msg with a payload of the url to navigate to.
This is will be handled in our top level update function as outlined in the previous chapter.
I&#8217;m not sold on it being a good solution, but it works !</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>we have already shown how the <code>contentView</code> function pattern matches on the route field of our model to render the appropriate page view</td>
</tr>
</table>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-elm" data-lang="elm">view : Signal.Address Action -&gt; Model -&gt; Html
view address model =
  div
    [ class "container-fluid" ]
    [ menu address model
    , div
        [ class "content"
        , style (TransitStyle.fadeSlideLeft     <i class="conum" data-value="1"></i><b>(1)</b>
                  100
                  (getTransition model))
        ]
        [ contentView address model ]
    ]</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>This is particulars related to animations performed when making page transtions from elm-transit-*
That part got lost in our upgrade adventure, but should be possible to plug back in in the future should we want to.</td>
</tr>
</table>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_summary">Summary</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Most of the changes went really smoothly and quickly. I did have to spend a little bit of time to get familiar with the new navigation and url-parser package, but they are pretty intuitive.
I wouldn&#8217;t be lying if I said I spent much more time on writing this blog post than doing the upgrade.
I also did quite a few changes to the implementation of details I haven&#8217;t shown you, just because I&#8217;ve become more confident with Elm than I was when writing the previous episodes.</p>
</div>
<div class="paragraph">
<p>It was quite a bit of changes in terms of LOC&#8217;s and I have to be honest and tell you it&#8217;t didn&#8217;t work once everything compiled. But you can hardly blame Elm for that,
it was all my bad. I hadn&#8217;t tested the route parsing properly and ended up implementing a loop. Kind of like a redirect loop, but all in js and out of reach for the browser.
Firing up the inline repl in Light Table and interactively testing the parser quickly showed me the errors of my ways.</p>
</div>
<div class="paragraph">
<p>All in all I have to say the upgrade was a really fun and enjoyable ride. I can definately say that
0.17 made the App turn out much nicer.</p>
</div>
<div class="paragraph">
<div class="title">What&#8217;s next ?</div>
<p>Hard to say for sure, but my current thinking is to start looking at auth using JWT web tokens.
Time will tell if that&#8217;s what it&#8217;ll be.</p>
</div>
<div class="sect2">
<h3 id="_appendix">Appendix</h3>
<div class="paragraph">
<p>Unfortunately the 0.17 release left elm-reactor a bit behind in terms of what it supports.
From my past experience with ClojureScript, I have gotten used to the feeback  loop you get by using the wonderful <a href="https://github.com/bhauman/lein-figwheel">figwheel</a>.
elm-reactor unfortunately doesn&#8217;t come close to that currently, so I had to turn to JS land for alternatives. After some evalutation and trials I ended up using
<a href="https://github.com/fluxxu/elm-hot-loader">elm-hot-loader</a>. It has worked out really nicely even though I ended up pulling down a fair chunk of the npm package repo.</p>
</div>
<div class="paragraph">
<p>I&#8217;m sure elm-reactor will be back with a vengeance in the not so distant future, packing some really cool and unique features.</p>
</div>
</div>
</div>
</div></p>

  <div id="disqus_thread"></div>
    <script type="text/javascript">
        var disqus_shortname = 'rundis';
	      var disqus_identifier = 'haskell_elm_spa_part5';
        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
	<hr />

		</div>
		<div id="push"></div>
    </div>

    <div id="footer">
      <div class="container">
        <p class="muted credit">&copy; 2015 Magnus Rundberget
          <a class="pull-right btn btn-xs" href="https://twitter.com/mrundberget"><i class="fa fa-twitter"></i></a>
          <a class="pull-right btn btn-xs" href="https://github.com/rundis"><i class="fa fa-github"></i></a>
          <a class="pull-right btn btn-xs" href="http://no.linkedin.com/in/mrundberget"><i class="fa fa-linkedin"></i></a>
        </p>
      </div>
    </div>

    <script src="../js/jquery-1.11.1.min.js"></script>
    <script src="../js/bootstrap.min.js"></script>
    <script src="../js/prettify.js"></script>
  </body>
</html>
